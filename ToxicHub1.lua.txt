-- Project Branzz TP - Vers√£o Atualizada
-- Interface Principal e Funcionalidades

-- Services
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local Workspace = game:GetService("Workspace")

-- Player
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")
local rootPart = character:WaitForChild("HumanoidRootPart")

-- Configura√ß√µes de cores baseadas no emoji ‚ò¢Ô∏è (tons suaves)
local COLOR_PRIMARY = Color3.fromRGB(100, 220, 100)    -- Verde suave radioativo
local COLOR_SECONDARY = Color3.fromRGB(70, 180, 70)     -- Verde mais escuro
local COLOR_ACCENT = Color3.fromRGB(180, 220, 180)      -- Verde claro
local COLOR_BACKGROUND = Color3.fromRGB(30, 40, 30)     -- Fundo escuro
local COLOR_TEXT = Color3.fromRGB(220, 240, 220)        -- Texto claro
local COLOR_BUTTON = Color3.fromRGB(50, 120, 50)        -- Bot√£o normal
local COLOR_BUTTON_HOVER = Color3.fromRGB(70, 150, 70)  -- Bot√£o hover
local COLOR_ON = Color3.fromRGB(80, 200, 80)            -- Verde ligado
local COLOR_OFF = Color3.fromRGB(120, 120, 120)         -- Cinza desligado
local COLOR_CLOSE = Color3.fromRGB(200, 80, 80)         -- Vermelho fechar
local COLOR_MINIMIZE = Color3.fromRGB(200, 180, 80)     -- Amarelo minimizar
local COLOR_MAXIMIZE = Color3.fromRGB(80, 150, 200)     -- Azul maximizar
local COLOR_HITBOX = Color3.fromRGB(255, 255, 255)      -- Branco para hitbox
local COLOR_HITBOX_TRANSPARENT = Color3.fromRGB(255, 255, 255) -- Branco semi-transparente

-- Vari√°veis de estado
local mainGuiVisible = true
local panelVisible = false
local mainGuiMinimized = false
local markedPosition = nil
local teleguidedActive = false
local teleportTeleguidedActive = false
local desyncV1Active = false
local desyncV2Active = false
local xRayActive = false
local hitboxExpanderActive = false
local infiniteJumpActive = false
local speedBoostActive = false
local espActive = false
local platforms = {}
local clones = {}
local espFolders = {}
local hitboxParts = {}
local antiRagdollEnabled = true
local antiResetEnabled = true
local antiKickEnabled = true

-- Fun√ß√£o para criar elementos de UI
local function createElement(className, properties)
	local element = Instance.new(className)
	for prop, value in pairs(properties) do
		if prop ~= "Parent" then
			element[prop] = value
		end
	end
	if properties.Parent then
		element.Parent = properties.Parent
	end
	return element
end

-- C√≠rculo principal (√≠cone flutuante) - POSI√á√ÉO AJUSTADA MAIS PARA BAIXO
local screenGui = createElement("ScreenGui", {
	Name = "BranzzTPGui",
	ResetOnSpawn = false,
	ZIndexBehavior = Enum.ZIndexBehavior.Sibling
})

local circleButton = createElement("ImageButton", {
	Name = "CircleButton",
	Parent = screenGui,
	BackgroundColor3 = COLOR_PRIMARY,
	BackgroundTransparency = 0.3,
	Size = UDim2.new(0, 50, 0, 50),
	Position = UDim2.new(0, 20, 0.6, -25), -- POSI√á√ÉO MAIS PARA BAIXO (0.6 em vez de 0.5)
	AnchorPoint = Vector2.new(0, 0.5),
	Image = "rbxassetid://0", -- Adicione uma imagem futuramente aqui
	ImageColor3 = COLOR_ACCENT,
	ScaleType = Enum.ScaleType.Crop,
	AutoButtonColor = false,
	BorderSizePixel = 0,
	ZIndex = 10
})

local circleUICorner = createElement("UICorner", {
	Parent = circleButton,
	CornerRadius = UDim.new(1, 0)
})

local circleUIGradient = createElement("UIGradient", {
	Parent = circleButton,
	Color = ColorSequence.new({
		ColorSequenceKeypoint.new(0, COLOR_PRIMARY),
		ColorSequenceKeypoint.new(1, COLOR_SECONDARY)
	}),
	Rotation = 45
})

-- GUI principal - POSI√á√ÉO AJUSTADA MAIS PARA BAIXO
local mainFrame = createElement("Frame", {
	Name = "MainFrame",
	Parent = screenGui,
	BackgroundColor3 = COLOR_BACKGROUND,
	BackgroundTransparency = 0.1,
	Size = UDim2.new(0, 300, 0, 400),
	Position = UDim2.new(0, 80, 0.6, -200), -- POSI√á√ÉO MAIS PARA BAIXO
	AnchorPoint = Vector2.new(0, 0.5),
	BorderSizePixel = 0,
	Visible = false,
	Active = true
})

local mainUICorner = createElement("UICorner", {
	Parent = mainFrame,
	CornerRadius = UDim.new(0, 8)
})

local mainUIStroke = createElement("UIStroke", {
	Parent = mainFrame,
	Color = COLOR_PRIMARY,
	Thickness = 2,
	Transparency = 0.5
})

-- Barra de t√≠tulo
local titleBar = createElement("Frame", {
	Name = "TitleBar",
	Parent = mainFrame,
	BackgroundColor3 = COLOR_SECONDARY,
	BackgroundTransparency = 0.2,
	Size = UDim2.new(1, 0, 0, 30),
	BorderSizePixel = 0
})

local titleUICorner = createElement("UICorner", {
	Parent = titleBar,
	CornerRadius = UDim.new(0, 8)
})

local titleText = createElement("TextLabel", {
	Name = "TitleText",
	Parent = titleBar,
	BackgroundTransparency = 1,
	Size = UDim2.new(0.6, 0, 1, 0),
	Position = UDim2.new(0.05, 0, 0, 0),
	Font = Enum.Font.GothamBold,
	Text = "Project Branzz Tp",
	TextColor3 = COLOR_TEXT,
	TextSize = 16,
	TextXAlignment = Enum.TextXAlignment.Left
})

-- Bot√µes da barra de t√≠tulo
local closeButton = createElement("TextButton", {
	Name = "CloseButton",
	Parent = titleBar,
	BackgroundColor3 = COLOR_CLOSE,
	BackgroundTransparency = 0.3,
	Size = UDim2.new(0, 25, 0, 25),
	Position = UDim2.new(1, -30, 0.5, -12.5),
	AnchorPoint = Vector2.new(1, 0.5),
	Font = Enum.Font.GothamBold,
	Text = "X",
	TextColor3 = Color3.new(1, 1, 1),
	TextSize = 14,
	AutoButtonColor = false,
	BorderSizePixel = 0
})

local closeUICorner = createElement("UICorner", {
	Parent = closeButton,
	CornerRadius = UDim.new(0, 4)
})

local minimizeButton = createElement("TextButton", {
	Name = "MinimizeButton",
	Parent = titleBar,
	BackgroundColor3 = COLOR_MINIMIZE,
	BackgroundTransparency = 0.3,
	Size = UDim2.new(0, 25, 0, 25),
	Position = UDim2.new(1, -60, 0.5, -12.5),
	AnchorPoint = Vector2.new(1, 0.5),
	Font = Enum.Font.GothamBold,
	Text = "-",
	TextColor3 = Color3.new(1, 1, 1),
	TextSize = 14,
	AutoButtonColor = false,
	BorderSizePixel = 0
})

local minimizeUICorner = createElement("UICorner", {
	Parent = minimizeButton,
	CornerRadius = UDim.new(0, 4)
})

local maximizeButton = createElement("TextButton", {
	Name = "MaximizeButton",
	Parent = titleBar,
	BackgroundColor3 = COLOR_MAXIMIZE,
	BackgroundTransparency = 0.3,
	Size = UDim2.new(0, 25, 0, 25),
	Position = UDim2.new(1, -90, 0.5, -12.5),
	AnchorPoint = Vector2.new(1, 0.5),
	Font = Enum.Font.GothamBold,
	Text = "+",
	TextColor3 = Color3.new(1, 1, 1),
	TextSize = 14,
	AutoButtonColor = false,
	BorderSizePixel = 0,
	Visible = false
})

local maximizeUICorner = createElement("UICorner", {
	Parent = maximizeButton,
	CornerRadius = UDim.new(0, 4)
})

-- √Årea de conte√∫do principal
local contentFrame = createElement("Frame", {
	Name = "ContentFrame",
	Parent = mainFrame,
	BackgroundTransparency = 1,
	Size = UDim2.new(1, -20, 1, -50),
	Position = UDim2.new(0, 10, 0, 40),
	Visible = true
})

local contentScroll = createElement("ScrollingFrame", {
	Name = "ContentScroll",
	Parent = contentFrame,
	BackgroundTransparency = 1,
	Size = UDim2.new(1, 0, 1, 0),
	CanvasSize = UDim2.new(0, 0, 0, 600),
	ScrollBarThickness = 4,
	ScrollBarImageColor3 = COLOR_PRIMARY,
	BorderSizePixel = 0
})

-- Painel secund√°rio (lado direito) - POSI√á√ÉO AJUSTADA MAIS PARA BAIXO
local panelFrame = createElement("Frame", {
	Name = "PanelFrame",
	Parent = screenGui,
	BackgroundColor3 = COLOR_BACKGROUND,
	BackgroundTransparency = 0.1,
	Size = UDim2.new(0, 280, 0, 350),
	Position = UDim2.new(1, -290, 0.6, -175), -- POSI√á√ÉO MAIS PARA BAIXO
	AnchorPoint = Vector2.new(1, 0.5),
	BorderSizePixel = 0,
	Visible = false,
	Active = true
})

local panelUICorner = createElement("UICorner", {
	Parent = panelFrame,
	CornerRadius = UDim.new(0, 8)
})

local panelUIStroke = createElement("UIStroke", {
	Parent = panelFrame,
	Color = COLOR_PRIMARY,
	Thickness = 2,
	Transparency = 0.5
})

local panelTitle = createElement("TextLabel", {
	Name = "PanelTitle",
	Parent = panelFrame,
	BackgroundColor3 = COLOR_SECONDARY,
	BackgroundTransparency = 0.2,
	Size = UDim2.new(1, 0, 0, 40),
	Font = Enum.Font.GothamBold,
	Text = "Segue la no TKK @Toxic_Hub009",
	TextColor3 = COLOR_TEXT,
	TextSize = 14,
	BorderSizePixel = 0
})

local panelTitleUICorner = createElement("UICorner", {
	Parent = panelTitle,
	CornerRadius = UDim.new(0, 8)
})

local panelContent = createElement("ScrollingFrame", {
	Name = "PanelContent",
	Parent = panelFrame,
	BackgroundTransparency = 1,
	Size = UDim2.new(1, -20, 1, -60),
	Position = UDim2.new(0, 10, 0, 50),
	CanvasSize = UDim2.new(0, 0, 0, 800),
	ScrollBarThickness = 4,
	ScrollBarImageColor3 = COLOR_PRIMARY,
	BorderSizePixel = 0
})

-- FUN√á√ÉO DE ARRASTAR MELHORADA PARA TODOS OS ELEMENTOS
local function makeDraggable(frame, handle)
	local dragging = false
	local dragInput, dragStart, startPos
	
	-- Fun√ß√£o para atualizar posi√ß√£o
	local function updatePosition(input)
		local delta = input.Position - dragStart
		frame.Position = UDim2.new(
			startPos.X.Scale, 
			startPos.X.Offset + delta.X,
			startPos.Y.Scale, 
			startPos.Y.Offset + delta.Y
		)
	end
	
	-- In√≠cio do arrasto
	handle.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
			dragging = true
			dragStart = input.Position
			startPos = frame.Position
			
			-- Capturar movimento
			local connection
			connection = input.Changed:Connect(function()
				if input.UserInputState == Enum.UserInputState.End then
					dragging = false
					if connection then
						connection:Disconnect()
					end
				end
			end)
		end
	end)
	
	-- Capturar entrada de movimento
	handle.InputChanged:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
			dragInput = input
		end
	end)
	
	-- Atualizar posi√ß√£o durante o arrasto
	UserInputService.InputChanged:Connect(function(input)
		if dragging and input == dragInput then
			updatePosition(input)
		end
	end)
end

-- Aplicar arrast√°vel a TODOS os elementos
makeDraggable(mainFrame, titleBar)
makeDraggable(panelFrame, panelTitle)
makeDraggable(circleButton, circleButton) -- AGORA O C√çRCULO TAMB√âM √â ARRAST√ÅVEL

-- Fun√ß√£o para criar bot√µes com toggle
local function createToggleButton(name, text, parent, yPosition, toggleCallback)
	local buttonFrame = createElement("Frame", {
		Name = name .. "Frame",
		Parent = parent,
		BackgroundTransparency = 1,
		Size = UDim2.new(1, 0, 0, 40),
		Position = UDim2.new(0, 0, 0, yPosition)
	})

	local button = createElement("TextButton", {
		Name = name .. "Button",
		Parent = buttonFrame,
		BackgroundColor3 = COLOR_BUTTON,
		Size = UDim2.new(1, 0, 0, 35),
		Font = Enum.Font.Gotham,
		Text = text,
		TextColor3 = COLOR_TEXT,
		TextSize = 14,
		AutoButtonColor = false,
		BorderSizePixel = 0
	})

	local buttonUICorner = createElement("UICorner", {
		Parent = button,
		CornerRadius = UDim.new(0, 6)
	})

	local statusIndicator = createElement("Frame", {
		Name = "StatusIndicator",
		Parent = button,
		BackgroundColor3 = COLOR_OFF,
		Size = UDim2.new(0, 10, 0, 10),
		Position = UDim2.new(1, -15, 0.5, -5),
		AnchorPoint = Vector2.new(1, 0.5),
		BorderSizePixel = 0
	})

	local statusUICorner = createElement("UICorner", {
		Parent = statusIndicator,
		CornerRadius = UDim.new(1, 0)
	})

	local enabled = false

	button.MouseButton1Click:Connect(function()
		enabled = not enabled
		if enabled then
			statusIndicator.BackgroundColor3 = COLOR_ON
			button.BackgroundColor3 = COLOR_BUTTON_HOVER
		else
			statusIndicator.BackgroundColor3 = COLOR_OFF
			button.BackgroundColor3 = COLOR_BUTTON
		end
		if toggleCallback then
			toggleCallback(enabled)
		end
	end)

	button.MouseEnter:Connect(function()
		if not enabled then
			button.BackgroundColor3 = COLOR_BUTTON_HOVER
		end
	end)

	button.MouseLeave:Connect(function()
		if not enabled then
			button.BackgroundColor3 = COLOR_BUTTON
		end
	end)

	return buttonFrame, function() return enabled end, function(state)
		enabled = state
		if enabled then
			statusIndicator.BackgroundColor3 = COLOR_ON
			button.BackgroundColor3 = COLOR_BUTTON_HOVER
		else
			statusIndicator.BackgroundColor3 = COLOR_OFF
			button.BackgroundColor3 = COLOR_BUTTON
		end
	end
end

-- Fun√ß√£o para criar campo de entrada
local function createInputField(name, placeholder, parent, yPosition)
	local inputFrame = createElement("Frame", {
		Name = name .. "Frame",
		Parent = parent,
		BackgroundTransparency = 1,
		Size = UDim2.new(1, 0, 0, 40),
		Position = UDim2.new(0, 0, 0, yPosition)
	})

	local textBox = createElement("TextBox", {
		Name = name .. "TextBox",
		Parent = inputFrame,
		BackgroundColor3 = COLOR_BACKGROUND,
		BackgroundTransparency = 0.5,
		Size = UDim2.new(1, 0, 0, 30),
		Font = Enum.Font.Gotham,
		Text = "",
		PlaceholderText = placeholder,
		TextColor3 = COLOR_TEXT,
		PlaceholderColor3 = Color3.fromRGB(150, 150, 150),
		TextSize = 14,
		BorderSizePixel = 0,
		ClearTextOnFocus = false
	})

	local textBoxUICorner = createElement("UICorner", {
		Parent = textBox,
		CornerRadius = UDim.new(0, 6)
	})

	return textBox
end

-- SISTEMA DE HITBOX EXPANDER ATUALIZADO
local function updateHitboxExpander(enabled, size)
	-- Limpar hitboxes antigas
	for _, part in ipairs(hitboxParts) do
		if part.Parent then
			part:Destroy()
		end
	end
	hitboxParts = {}
	
	if not enabled then return end
	
	local hitboxSize = tonumber(size) or 3
	if hitboxSize < 1 then hitboxSize = 1 end
	if hitboxSize > 10 then hitboxSize = 10 end
	
	-- Criar hitboxes para todos os jogadores
	for _, plr in ipairs(Players:GetPlayers()) do
		if plr ~= player and plr.Character then
			local char = plr.Character
			local root = char:FindFirstChild("HumanoidRootPart")
			local humanoid = char:FindFirstChild("Humanoid")
			
			if root and humanoid and humanoid.Health > 0 then
				-- Criar uma parte maior em volta do jogador
				local hitbox = createElement("Part", {
					Name = "Hitbox_" .. plr.Name,
					Parent = Workspace,
					Size = Vector3.new(5 * hitboxSize, 8 * hitboxSize, 5 * hitboxSize),
					CFrame = root.CFrame,
					Color = COLOR_HITBOX,
					Material = Enum.Material.Neon,
					Transparency = 0.7, -- Branco semi-transparente
					Anchored = false,
					CanCollide = false, -- Permite atravessar
					CanTouch = true, -- Permite interagir
					CastShadow = false
				})
				
				-- Conectar a posi√ß√£o do jogador
				local weld = createElement("Weld", {
					Parent = hitbox,
					Part0 = hitbox,
					Part1 = root,
					C0 = CFrame.new(0, 0, 0)
				})
				
				-- Adicionar detector de toque
				hitbox.Touched:Connect(function(otherPart)
					-- Permitir que o jogador interaja com a hitbox
					if otherPart.Parent == character then
						-- O jogador pode "bater" na hitbox
						-- Implemente aqui a l√≥gica de dano se necess√°rio
					end
				end)
				
				table.insert(hitboxParts, hitbox)
			end
		end
	end
end

-- Criar bot√µes na GUI principal
local buttonY = 0
local buttonSpacing = 45

-- 1. X-ray
local xrayButton, getXrayState, setXrayState = createToggleButton("Xray", "1. X-ray", contentScroll, buttonY, function(enabled)
	xRayActive = enabled
	if enabled then
		for _, part in ipairs(Workspace:GetDescendants()) do
			if part:IsA("BasePart") and part.Transparency < 0.9 then
				part.LocalTransparencyModifier = 0.8
			end
		end
	else
		for _, part in ipairs(Workspace:GetDescendants()) do
			if part:IsA("BasePart") then
				part.LocalTransparencyModifier = 0
			end
		end
	end
end)
buttonY += buttonSpacing

-- 2. Super Boost
local superBoostButton = createElement("TextButton", {
	Name = "SuperBoostButton",
	Parent = contentScroll,
	BackgroundColor3 = COLOR_BUTTON,
	Size = UDim2.new(1, 0, 0, 35),
	Position = UDim2.new(0, 0, 0, buttonY),
	Font = Enum.Font.Gotham,
	Text = "2. Super Boost",
	TextColor3 = COLOR_TEXT,
	TextSize = 14,
	AutoButtonColor = false,
	BorderSizePixel = 0
})
local superBoostUICorner = createElement("UICorner", {Parent = superBoostButton, CornerRadius = UDim.new(0, 6)})
superBoostButton.MouseButton1Click:Connect(function()
	-- Otimiza√ß√µes de performance
	settings().Rendering.QualityLevel = 1
	settings().Rendering.MeshPartDetailLevel = Enum.MeshPartDetailLevel.Level01
	for _, v in ipairs(Workspace:GetDescendants()) do
		if v:IsA("BasePart") then
			v.Material = Enum.Material.Plastic
			v.Reflectance = 0
		end
	end
end)
superBoostButton.MouseEnter:Connect(function() superBoostButton.BackgroundColor3 = COLOR_BUTTON_HOVER end)
superBoostButton.MouseLeave:Connect(function() superBoostButton.BackgroundColor3 = COLOR_BUTTON end)
buttonY += buttonSpacing

-- 3. Hitbox Expander ATUALIZADO
local hitboxButton, getHitboxState, setHitboxState = createToggleButton("Hitbox", "3. Hitbox Expander", contentScroll, buttonY, function(enabled)
	hitboxExpanderActive = enabled
	updateHitboxExpander(enabled, hitboxSizeInput.Text)
end)
buttonY += buttonSpacing

local hitboxSizeInput = createInputField("HitboxSize", "Tamanho da Hitbox (1-10)", contentScroll, buttonY)
hitboxSizeInput:GetPropertyChangedSignal("Text"):Connect(function()
	if hitboxExpanderActive then
		updateHitboxExpander(true, hitboxSizeInput.Text)
	end
end)
buttonY += buttonSpacing

-- 4. Abrir Painel
local openPanelButton = createElement("TextButton", {
	Name = "OpenPanelButton",
	Parent = contentScroll,
	BackgroundColor3 = COLOR_BUTTON,
	Size = UDim2.new(1, 0, 0, 35),
	Position = UDim2.new(0, 0, 0, buttonY),
	Font = Enum.Font.Gotham,
	Text = "4. Abrir Painel‚ò¢Ô∏è",
	TextColor3 = COLOR_TEXT,
	TextSize = 14,
	AutoButtonColor = false,
	BorderSizePixel = 0
})
local openPanelUICorner = createElement("UICorner", {Parent = openPanelButton, CornerRadius = UDim.new(0, 6)})
openPanelButton.MouseButton1Click:Connect(function()
	panelVisible = not panelVisible
	panelFrame.Visible = panelVisible
end)
openPanelButton.MouseEnter:Connect(function() openPanelButton.BackgroundColor3 = COLOR_BUTTON_HOVER end)
openPanelButton.MouseLeave:Connect(function() openPanelButton.BackgroundColor3 = COLOR_BUTTON end)
buttonY += buttonSpacing

-- Atualizar tamanho do canvas do scroll
contentScroll.CanvasSize = UDim2.new(0, 0, 0, buttonY + 50)

-- Criar bot√µes no painel secund√°rio
local panelButtonY = 0
local panelButtonSpacing = 50

-- 1. Mark Position
local markPositionButton = createElement("TextButton", {
	Name = "MarkPositionButton",
	Parent = panelContent,
	BackgroundColor3 = COLOR_BUTTON,
	Size = UDim2.new(1, 0, 0, 35),
	Position = UDim2.new(0, 0, 0, panelButtonY),
	Font = Enum.Font.Gotham,
	Text = "1. Mark Positionüìç",
	TextColor3 = COLOR_TEXT,
	TextSize = 14,
	AutoButtonColor = false,
	BorderSizePixel = 0
})
local markPositionUICorner = createElement("UICorner", {Parent = markPositionButton, CornerRadius = UDim.new(0, 6)})
markPositionButton.MouseButton1Click:Connect(function()
	if markedPosition then
		-- Criar notifica√ß√£o visual
		local notification = createElement("TextLabel", {
			Parent = screenGui,
			BackgroundColor3 = COLOR_BACKGROUND,
			BackgroundTransparency = 0.2,
			Size = UDim2.new(0, 250, 0, 50),
			Position = UDim2.new(0.5, -125, 0.8, 0),
			Font = Enum.Font.Gotham,
			Text = "Posi√ß√£o j√° marcada! Use Clear Position primeiro.",
			TextColor3 = COLOR_TEXT,
			TextSize = 12,
			BorderSizePixel = 0
		})
		local notifUICorner = createElement("UICorner", {Parent = notification, CornerRadius = UDim.new(0, 8)})
		task.wait(3)
		notification:Destroy()
	else
		markedPosition = rootPart.Position
		-- Criar indicador visual
		local marker = createElement("Part", {
			Parent = Workspace,
			Name = "PositionMarker",
			Position = markedPosition + Vector3.new(0, 5, 0),
			Size = Vector3.new(2, 2, 2),
			Color = COLOR_PRIMARY,
			Material = Enum.Material.Neon,
			Transparency = 0.5,
			Anchored = true,
			CanCollide = false
		})
		task.spawn(function()
			while markedPosition and marker.Parent do
				marker.Color = COLOR_PRIMARY
				task.wait(0.5)
				marker.Color = COLOR_ACCENT
				task.wait(0.5)
			end
		end)
	end
end)
markPositionButton.MouseEnter:Connect(function() markPositionButton.BackgroundColor3 = COLOR_BUTTON_HOVER end)
markPositionButton.MouseLeave:Connect(function() markPositionButton.BackgroundColor3 = COLOR_BUTTON end)
panelButtonY += panelButtonSpacing

-- Clear Position
local clearPositionButton = createElement("TextButton", {
	Name = "ClearPositionButton",
	Parent = panelContent,
	BackgroundColor3 = Color3.fromRGB(200, 80, 80),
	Size = UDim2.new(1, 0, 0, 30),
	Position = UDim2.new(0, 0, 0, panelButtonY),
	Font = Enum.Font.Gotham,
	Text = "Clear PositionüóëÔ∏è",
	TextColor3 = COLOR_TEXT,
	TextSize = 12,
	AutoButtonColor = false,
	BorderSizePixel = 0
})
local clearPositionUICorner = createElement("UICorner", {Parent = clearPositionButton, CornerRadius = UDim.new(0, 6)})
clearPositionButton.MouseButton1Click:Connect(function()
	markedPosition = nil
	for _, obj in ipairs(Workspace:GetChildren()) do
		if obj.Name == "PositionMarker" then
			obj:Destroy()
		end
	end
end)
clearPositionButton.MouseEnter:Connect(function() clearPositionButton.BackgroundColor3 = Color3.fromRGB(220, 100, 100) end)
clearPositionButton.MouseLeave:Connect(function() clearPositionButton.BackgroundColor3 = Color3.fromRGB(200, 80, 80) end)
panelButtonY += panelButtonSpacing

-- 2. Teleguiado ATUALIZADO com efeito de queda
local teleguidedButton, getTeleguidedState, setTeleguidedState = createToggleButton("Teleguided", "2. Teleguiado", panelContent, panelButtonY, function(enabled)
	teleguidedActive = enabled
	if enabled then
		-- Ativar sistema de voo com efeito de queda
		humanoid.PlatformStand = true
		rootPart.Anchored = false
		
		-- EFEITO DE QUEDA: Aplicar velocidade vertical negativa
		local fallVelocity = Vector3.new(0, -50, 0) -- Velocidade de queda
		
		-- Criar plataformas peri√≥dicas
		task.spawn(function()
			while teleguidedActive do
				task.wait(6) -- Espera 6 segundos antes da primeira plataforma
				if teleguidedActive then
					local platform = createElement("Part", {
						Parent = Workspace,
						Size = Vector3.new(10, 1, 10),
						Color = COLOR_PRIMARY,
						Transparency = 0.7,
						Material = Enum.Material.Plastic,
						Anchored = true,
						CanCollide = true
					})
					platform.Position = rootPart.Position - Vector3.new(0, 3, 0)
					table.insert(platforms, platform)
					task.wait(3) -- Nova plataforma a cada 3 segundos
				end
			end
		end)
		
		-- Sistema de movimento ATUALIZADO com efeito de queda
		local connection
		connection = RunService.Heartbeat:Connect(function(delta)
			if teleguidedActive and rootPart then
				local camera = Workspace.CurrentCamera
				local direction = camera.CFrame.LookVector
				
				-- Combina√ß√£o: dire√ß√£o da c√¢mera + efeito de queda
				local combinedVelocity = (direction * 28) + fallVelocity
				rootPart.Velocity = combinedVelocity
				
				-- Efeito visual de queda (opcional)
				if math.random(1, 20) == 1 then
					-- Criar part√≠culas de vento/queda
					local particle = createElement("Part", {
						Parent = Workspace,
						Size = Vector3.new(0.5, 0.5, 0.5),
						Color = COLOR_ACCENT,
						Transparency = 0.8,
						Material = Enum.Material.Neon,
						Anchored = true,
						CanCollide = false,
						Position = rootPart.Position + Vector3.new(
							math.random(-5, 5),
							math.random(-2, 2),
							math.random(-5, 5)
						)
					})
					game.Debris:AddItem(particle, 1)
				end
			elseif connection then
				connection:Disconnect()
			end
		end)
	else
		humanoid.PlatformStand = false
		-- Limpar plataformas
		for _, platform in ipairs(platforms) do
			platform:Destroy()
		end
		platforms = {}
	end
end)
panelButtonY += panelButtonSpacing

-- 3. Tp Teleguiado ATUALIZADO - vai reto pelo ar
local teleportTeleguidedButton, getTeleportTeleguidedState, setTeleportTeleguidedState = createToggleButton("TeleportTeleguided", "3. Tp Teleguiado", panelContent, panelButtonY, function(enabled)
	teleportTeleguidedActive = enabled
	if enabled and markedPosition then
		-- Sistema de teleporte direcional RETO PELO AR
		humanoid.PlatformStand = true
		rootPart.Anchored = false
		
		-- Calcular dire√ß√£o reta para a posi√ß√£o marcada
		local startPos = rootPart.Position
		local targetPos = markedPosition
		local direction = (targetPos - startPos).Unit
		
		-- Altura fixa para voo reto pelo ar
		local flightHeight = math.max(startPos.Y, targetPos.Y) + 20
		
		-- Criar plataformas durante o teleporte
		task.spawn(function()
			while teleportTeleguidedActive and markedPosition do
				task.wait(7) -- Espera 7 segundos
				if teleportTeleguidedActive then
					local platform = createElement("Part", {
						Parent = Workspace,
						Size = Vector3.new(8, 1, 8),
						Color = COLOR_ACCENT,
						Transparency = 0.6,
						Material = Enum.Material.Plastic,
						Anchored = true,
						CanCollide = true
					})
					platform.Position = Vector3.new(
						rootPart.Position.X,
						flightHeight - 5, -- Plataforma um pouco abaixo da altura de voo
						rootPart.Position.Z
					)
					table.insert(platforms, platform)
					task.wait(2) -- Nova plataforma a cada 2 segundos
				end
			end
		end)
		
		-- Movimento em linha reta pelo ar
		local connection
		connection = RunService.Heartbeat:Connect(function()
			if teleportTeleguidedActive and markedPosition then
				local currentPos = rootPart.Position
				local distance = (targetPos - currentPos).Magnitude
				
				if distance < 5 then
					-- Chegou no destino
					setTeleportTeleguidedState(false)
					humanoid.PlatformStand = false
					if connection then
						connection:Disconnect()
					end
				else
					-- Manter altura de voo constante
					local horizontalDir = Vector3.new(direction.X, 0, direction.Z).Unit
					local verticalAdjustment = (flightHeight - currentPos.Y) * 0.1
					
					-- Velocidade com componente horizontal e ajuste vertical
					rootPart.Velocity = (horizontalDir * 25) + Vector3.new(0, verticalAdjustment, 0)
				end
			end
		end)
	else
		humanoid.PlatformStand = false
		setTeleportTeleguidedState(false)
	end
end)
panelButtonY += panelButtonSpacing

-- 4. Desync V1
local desyncV1Button, getDesyncV1State, setDesyncV1State = createToggleButton("DesyncV1", "4. Desync V1", panelContent, panelButtonY, function(enabled)
	desyncV1Active = enabled
	if enabled then
		-- Sistema Desync V1
		local clone = character:Clone()
		clone.Name = "DesyncCloneV1"
		clone.Parent = Workspace
		
		-- Posicionar clone
		for _, part in ipairs(clone:GetDescendants()) do
			if part:IsA("BasePart") then
				part.Anchored = true
				part.Transparency = 0.5
				part.Color = COLOR_PRIMARY
			end
		end
		
		clone:MoveTo(rootPart.Position)
		table.insert(clones, clone)
		
		-- Tornar personagem original "invis√≠vel" para outros
		rootPart.Transparency = 1
		for _, part in ipairs(character:GetDescendants()) do
			if part:IsA("BasePart") then
				part.LocalTransparencyModifier = 0.9
			end
		end
	else
		-- Limpar desync
		for _, clone in ipairs(clones) do
			clone:Destroy()
		end
		clones = {}
		
		-- Restaurar visibilidade
		rootPart.Transparency = 0
		for _, part in ipairs(character:GetDescendants()) do
			if part:IsA("BasePart") then
				part.LocalTransparencyModifier = 0
			end
		end
	end
end)
panelButtonY += panelButtonSpacing

-- Desync V2
local desyncV2Button, getDesyncV2State, setDesyncV2State = createToggleButton("DesyncV2", "Desync V2", panelContent, panelButtonY, function(enabled)
	desyncV2Active = enabled
	if enabled then
		-- Sistema Desync V2 com clone lagado
		local clone = character:Clone()
		clone.Name = "DesyncCloneV2"
		clone.Parent = Workspace
		
		-- Configurar clone
		for _, part in ipairs(clone:GetDescendants()) do
			if part:IsA("BasePart") then
				part.Anchored = false
				part.Transparency = 0.3
				part.Color = COLOR_SECONDARY
				part.CanCollide = false
			end
		end
		
		clone:MoveTo(rootPart.Position)
		table.insert(clones, clone)
		
		-- Movimento "lagado" do clone
		task.spawn(function()
			while desyncV2Active and clone.Parent do
				-- Movimento err√°tico
				local hum = clone:FindFirstChild("Humanoid")
				if hum then
					hum:Move(Vector3.new(
						math.random(-10, 10),
						0,
						math.random(-10, 10)
					))
				end
				task.wait(math.random(1, 3)) -- Lag simulado
			end
		end)
		
		-- Ocultar personagem real
		rootPart.Transparency = 1
		for _, part in ipairs(character:GetDescendants()) do
			if part:IsA("BasePart") then
				part.LocalTransparencyModifier = 0.9
			end
		end
	else
		-- Limpar desync
		for _, clone in ipairs(clones) do
			clone:Destroy()
		end
		clones = {}
		
		-- Restaurar visibilidade
		rootPart.Transparency = 0
		for _, part in ipairs(character:GetDescendants()) do
			if part:IsA("BasePart") then
				part.LocalTransparencyModifier = 0
			end
		end
	end
end)
panelButtonY += panelButtonSpacing

-- 5. Anti Lag - FPS Boost
local antiLagButton = createElement("TextButton", {
	Name = "AntiLagButton",
	Parent = panelContent,
	BackgroundColor3 = COLOR_BUTTON,
	Size = UDim2.new(1, 0, 0, 35),
	Position = UDim2.new(0, 0, 0, panelButtonY),
	Font = Enum.Font.Gotham,
	Text = "5. Anti Lag - FPS Boost",
	TextColor3 = COLOR_TEXT,
	TextSize = 14,
	AutoButtonColor = false,
	BorderSizePixel = 0
})
local antiLagUICorner = createElement("UICorner", {Parent = antiLagButton, CornerRadius = UDim.new(0, 6)})
antiLagButton.MouseButton1Click:Connect(function()
	-- Remover texturas e efeitos pesados
	for _, obj in ipairs(Workspace:GetDescendants()) do
		if obj:IsA("BasePart") then
			obj.Material = Enum.Material.Plastic
			obj.Reflectance = 0
			if obj:FindFirstChildOfClass("Decal") then
				for _, decal in ipairs(obj:GetChildren()) do
					if decal:IsA("Decal") then
						decal:Destroy()
					end
				end
			end
		elseif obj:IsA("ParticleEmitter") or obj:IsA("Fire") or obj:IsA("Smoke") then
			obj:Destroy()
		elseif obj:IsA("SpecialMesh") or obj:IsA("MeshPart") then
			obj.TextureId = ""
		end
	end
	
	-- Reduzir qualidade gr√°fica
	settings().Rendering.QualityLevel = 1
	settings().Rendering.EagerBulkExecution = true
end)
antiLagButton.MouseEnter:Connect(function() antiLagButton.BackgroundColor3 = COLOR_BUTTON_HOVER end)
antiLagButton.MouseLeave:Connect(function() antiLagButton.BackgroundColor3 = COLOR_BUTTON end)
panelButtonY += panelButtonSpacing

-- 6. ESP Player + Line (simplificado para exemplo)
local espButton, getEspState, setEspState = createToggleButton("ESP", "6. ESP Player + Line", panelContent, panelButtonY, function(enabled)
	espActive = enabled
end)
panelButtonY += panelButtonSpacing

-- 7. Infinite Jump
local infiniteJumpButton, getInfiniteJumpState, setInfiniteJumpState = createToggleButton("InfiniteJump", "7. Infinite Jump", panelContent, panelButtonY, function(enabled)
	infiniteJumpActive = enabled
	if enabled then
		-- Modificar propriedades do humanoid
		humanoid.JumpPower = 50
		humanoid.JumpHeight = 10
		
		-- Conectar para pulos infinitos
		local connection
		connection = UserInputService.JumpRequest:Connect(function()
			if infiniteJumpActive then
				humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
			end
		end)
		
		-- Cair mais devagar
		Workspace.Gravity = 50
	else
		-- Restaurar valores padr√£o
		humanoid.JumpPower = 50
		humanoid.JumpHeight = 7.2
		Workspace.Gravity = 196.2
	end
end)
panelButtonY += panelButtonSpacing

-- 8. Speed Boost
local speedBoostButton, getSpeedBoostState, setSpeedBoostState = createToggleButton("SpeedBoost", "8. Speed Boost", panelContent, panelButtonY, function(enabled)
	speedBoostActive = enabled
	if enabled then
		-- Sistema de impulso peri√≥dico
		task.spawn(function()
			while speedBoostActive do
				task.wait(3) -- Espera 3 segundos
				if speedBoostActive then
					-- Aplicar impulso
					local boost = Instance.new("BodyVelocity")
					boost.Velocity = rootPart.CFrame.LookVector * 100
					boost.MaxForce = Vector3.new(10000, 10000, 10000)
					boost.Parent = rootPart
					
					task.wait(6) -- Dura√ß√£o do impulso
					
					if boost.Parent then
						boost:Destroy()
					end
				end
			end
		end)
	end
end)

-- Atualizar tamanho do canvas do painel
panelContent.CanvasSize = UDim2.new(0, 0, 0, panelButtonY + 50)

-- Sistema Anti-Ragdoll
local function setupAntiRagdoll()
	if antiRagdollEnabled then
		humanoid.BreakJointsOnDeath = false
		humanoid:SetStateEnabled(Enum.HumanoidStateType.FallingDown, false)
		humanoid:SetStateEnabled(Enum.HumanoidStateType.Ragdoll, false)
	end
end

-- Sistema Anti-Reset
local function setupAntiReset()
	if antiResetEnabled then
		player.CharacterAdded:Connect(function(newChar)
			if not antiResetEnabled then return end
			
			task.wait(0.1)
			local newRoot = newChar:WaitForChild("HumanoidRootPart")
			local newHumanoid = newChar:WaitForChild("Humanoid")
			
			-- Preservar posi√ß√£o do clone se existir
			if #clones > 0 then
				local lastClone = clones[#clones]
				if lastClone and lastClone.Parent then
					local cloneRoot = lastClone:FindFirstChild("HumanoidRootPart")
					if cloneRoot then
						newRoot.CFrame = cloneRoot.CFrame
					end
				end
			end
			
			-- Restaurar estados ativos
			if infiniteJumpActive then
				setInfiniteJumpState(true)
			end
			if speedBoostActive then
				setSpeedBoostState(true)
			end
			if teleguidedActive then
				setTeleguidedState(true)
			end
		end)
	end
end

-- Sistema Anti-Kick
local function setupAntiKick()
	if antiKickEnabled then
		-- Monitorar tentativas de kick
		local meta = getrawmetatable(game)
		local oldNamecall = meta.__namecall
		
		setreadonly(meta, false)
		meta.__namecall = newcclosure(function(self, ...)
			local method = getnamecallmethod()
			local args = {...}
			
			if method == "Kick" or method == "kick" then
				if antiKickEnabled then
					warn("[Anti-Kick] Tentativa de kick bloqueada")
					return nil
				end
			end
			
			return oldNamecall(self, ...)
		end)
		setreadonly(meta, true)
	end
end

-- Fun√ß√µes do arquivo Desync.txt
local function applyDesyncFlags()
	local FFlags = {
		GameNetPVHeaderRotationalVelocityZeroCutoffExponent = -5000,
		LargeReplicatorWrite5 = true,
		LargeReplicatorEnabled9 = true,
		AngularVelociryLimit = 360,
		TimestepArbiterVelocityCriteriaThresholdTwoDt = 2147483646,
		S2PhysicsSenderRate = 15000,
		DisableDPIScale = true,
		MaxDataPacketPerSend = 2147483647,
		PhysicsSenderMaxBandwidthBps = 20000,
		TimestepArbiterHumanoidLinearVelThreshold = 21,
		MaxMissedWorldStepsRemembered = -2147483648,
		PlayerHumanoidPropertyUpdateRestrict = true,
		SimDefaultHumanoidTimestepMultiplier = 0,
		StreamJobNOUVolumeLengthCap = 2147483647,
		DebugSendDistInSteps = -2147483648,
		GameNetDontSendRedundantNumTimes = 1,
		CheckPVLinearVelocityIntegrateVsDeltaPositionThresholdPercent = 1,
		CheckPVDifferencesForInterpolationMinVelThresholdStudsPerSecHundredth = 1,
		LargeReplicatorSerializeRead3 = true,
		ReplicationFocusNouExtentsSizeCutoffForPauseStuds = 2147483647,
		CheckPVCachedVelThresholdPercent = 10,
		CheckPVDifferencesForInterpolationMinRotVelThresholdRadsPerSecHundredth = 1,
		GameNetDontSendRedundantDeltaPositionMillionth = 1,
		InterpolationFrameVelocityThresholdMillionth = 5,
		StreamJobNOUVolumeCap = 2147483647,
		InterpolationFrameRotVelocityThresholdMillionth = 5,
		CheckPVCachedRotVelThresholdPercent = 10,
		WorldStepMax = 30,
		InterpolationFramePositionThresholdMillionth = 5,
		TimestepArbiterHumanoidTurningVelThreshold = 1,
		SimOwnedNOUCountThresholdMillionth = 2147483647,
		GameNetPVHeaderLinearVelocityZeroCutoffExponent = -5000,
		NextGenReplicatorEnabledWrite4 = true,
		TimestepArbiterOmegaThou = 1073741823,
		MaxAcceptableUpdateDelay = 1,
		LargeReplicatorSerializeWrite4 = true
	}
	
	for name, value in pairs(FFlags) do
		pcall(function()
			if type(value) == "boolean" then
				value = value and "true" or "false"
			end
			setfflag(tostring(name), tostring(value))
		end)
	end
end

-- Configurar intera√ß√µes
circleButton.MouseButton1Click:Connect(function()
	mainGuiVisible = not mainGuiVisible
	mainFrame.Visible = mainGuiVisible
end)

closeButton.MouseButton1Click:Connect(function()
	mainGuiVisible = false
	mainFrame.Visible = false
	panelVisible = false
	panelFrame.Visible = false
end)

minimizeButton.MouseButton1Click:Connect(function()
	mainGuiMinimized = true
	contentFrame.Visible = false
	minimizeButton.Visible = false
	maximizeButton.Visible = true
	mainFrame.Size = UDim2.new(0, 300, 0, 80)
end)

maximizeButton.MouseButton1Click:Connect(function()
	mainGuiMinimized = false
	contentFrame.Visible = true
	minimizeButton.Visible = true
	maximizeButton.Visible = false
	mainFrame.Size = UDim2.new(0, 300, 0, 400)
end)

-- Aplicar efeitos visuais de hover
local function setupHoverEffects()
	local buttons = {closeButton, minimizeButton, maximizeButton, superBoostButton, openPanelButton, 
		markPositionButton, clearPositionButton, antiLagButton}
	
	for _, button in ipairs(buttons) do
		button.MouseEnter:Connect(function()
			button.BackgroundTransparency = 0.1
		end)
		button.MouseLeave:Connect(function()
			button.BackgroundTransparency = 0.3
		end)
	end
end

-- Limpeza autom√°tica de plataformas e hitboxes
game.Debris:AddItem(circleButton, 0)
game.Debris:AddItem(mainFrame, 0)
game.Debris:AddItem(panelFrame, 0)

-- Inicializa√ß√£o
screenGui.Parent = player:WaitForChild("PlayerGui")
setupHoverEffects()
setupAntiRagdoll()
setupAntiReset()
setupAntiKick()
applyDesyncFlags()

print("Project Branzz TP ATUALIZADO Carregado!")
print("Ajustes aplicados:")
print("1. Bot√£o do c√≠rculo agora √© arrast√°vel")
print("2. GUIs posicionadas mais para baixo")
print("3. Hitbox Expander mostra em branco e permite intera√ß√£o")
print("4. Teleguiado tem efeito de queda")
print("5. Tp Teleguiado vai reto pelo ar")